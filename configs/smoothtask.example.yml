# Интервал опроса системы в миллисекундах (100-60000 мс)
# Определяет, как часто демон собирает метрики и обновляет приоритеты процессов
polling_interval_ms: 500

# Максимальное количество кандидатов для обработки за одну итерацию (1-10000)
# Ограничивает количество процессов/групп, которые обрабатываются за раз
max_candidates: 150

# Режим "сухого прогона" по умолчанию
# Если true, демон не будет применять изменения приоритетов, только планировать их
# Полезно для тестирования и отладки
dry_run_default: false

# Режим работы Policy Engine:
# - rules-only: только правила, без ML-ранкера (по умолчанию)
#   Используются жёсткие правила (guardrails) и семантические правила
# - hybrid: правила + ML-ранкер для определения приоритетов
#   Сначала применяются правила, затем ML-ранкер ранжирует группы внутри классов
policy_mode: rules-only

# Включение логирования снапшотов в SQLite
# Если true, демон будет сохранять снапшоты метрик в базу данных
# Полезно для обучения ML-моделей и анализа работы системы
# Если false, логирование отключено (может улучшить производительность)
enable_snapshot_logging: true

paths:
  # Путь к SQLite базе данных для сохранения снапшотов
  # Используется для логирования метрик и обучения ML-моделей
  # Файл должен иметь расширение .sqlite или .db
  snapshot_db_path: "/var/lib/smoothtask/snapshots.sqlite"
  
  # Директория с YAML файлами паттернов приложений
  # Паттерны используются для классификации процессов по типам (GUI/CLI/batch/...)
  # и определения тегов (browser/ide/game/audio/...)
  patterns_dir: "/etc/smoothtask/patterns"

thresholds:
  # Порог PSI CPU "some" для определения высокой нагрузки (0.0-1.0)
  # Когда PSI CPU some превышает этот порог, система считается под нагрузкой
  psi_cpu_some_high: 0.6
  
  # Порог PSI IO "some" для определения высокой нагрузки (0.0-1.0)
  # Когда PSI IO some превышает этот порог, система считается под нагрузкой
  psi_io_some_high: 0.4
  
  # Таймаут неактивности пользователя в секундах (1-86400 сек)
  # Если пользователь не взаимодействовал с системой дольше этого времени,
  # процессы могут быть переведены в фоновый режим
  user_idle_timeout_sec: 120
  
  # Период отсрочки для интерактивных сборок в секундах (1-3600 сек)
  # Время, в течение которого процессы сборки остаются в интерактивном режиме
  # после последнего пользовательского ввода
  interactive_build_grace_sec: 10
  
  # Порог доли CPU для определения "шумного соседа" (0.0-1.0)
  # Процессы, использующие больше этой доли CPU, считаются шумными соседями
  # и могут получить пониженный приоритет
  noisy_neighbour_cpu_share: 0.7

  # Перцентиль для класса CritInteractive (0.0-1.0)
  # Группы с percentile >= этого значения получают класс CritInteractive
  # (самый высокий приоритет для критичных интерактивных приложений)
  crit_interactive_percentile: 0.9
  
  # Перцентиль для класса Interactive (0.0-1.0)
  # Группы с percentile >= этого значения получают класс Interactive
  # (высокий приоритет для интерактивных приложений)
  interactive_percentile: 0.6
  
  # Перцентиль для класса Normal (0.0-1.0)
  # Группы с percentile >= этого значения получают класс Normal
  # (обычный приоритет для стандартных приложений)
  normal_percentile: 0.3
  
  # Перцентиль для класса Background (0.0-1.0)
  # Группы с percentile >= этого значения получают класс Background
  # (низкий приоритет для фоновых процессов)
  background_percentile: 0.1
  
  # Порог P99 scheduling latency в миллисекундах (5-100 мс)
  # Используется для определения плохой отзывчивости системы
  # Если scheduling latency превышает этот порог, система считается неотзывчивой
  sched_latency_p99_threshold_ms: 20.0
  
  # Порог P95 UI loop latency в миллисекундах (5-100 мс)
  # Используется для определения плохой отзывчивости UI
  # Если UI loop latency превышает этот порог, UI считается неотзывчивым
  ui_loop_p95_threshold_ms: 16.67

# Конфигурация системы уведомлений
# Управляет отправкой уведомлений пользователю о важных событиях
# Уведомления помогают мониторить работу демона и получать оповещения о критических ситуациях
notifications:
  # Включить отправку уведомлений
  # Если false, уведомления не отправляются (рекомендуется для production)
  # Включение уведомлений может быть полезно для отладки и мониторинга
  enabled: false
  
  # Тип бэкенда для отправки уведомлений:
  # - stub: заглушка для тестирования (только логирование через tracing)
  #   Полезно для разработки и тестирования, когда реальные уведомления не нужны
  # - libnotify: desktop уведомления через системную библиотеку libnotify
  #   Рекомендуется для production использования, требует наличия libnotify
  #   Уведомления будут отображаться в системном трее пользователя
  backend: stub
  
  # Имя приложения для уведомлений
  # Отображается в desktop уведомлениях для идентификации источника
  # Должно быть кратким и информативным
  app_name: "SmoothTask"
  
  # Минимальный уровень важности для отправки уведомлений:
  # - critical: только критические уведомления
  #   Самый высокий приоритет, используется для фатальных ошибок
  #   Рекомендуется для production, чтобы избежать информационного шума
  # - warning: предупреждения и критические уведомления (рекомендуется)
  #   Средний приоритет, включает важные предупреждения и критические ошибки
  #   Хороший баланс между информативностью и шумом
  # - info: все уведомления (может быть шумно)
  #   Низкий приоритет, включает все уведомления, включая информационные
  #   Полезно для отладки и разработки, но может быть слишком шумно для production
  min_level: warning

# Конфигурация ML-модели для ранжирования AppGroup
# Управляет загрузкой и использованием ML-модели в hybrid режиме Policy Engine
# Позволяет использовать обученные модели CatBoost для более точного ранжирования
model:
  # Включить использование ML-модели для ранжирования
  # Если true, Policy Engine будет пытаться загрузить и использовать ML-модель
  # для ранжирования AppGroup в hybrid режиме
  # Если false, будет использоваться заглушка (StubRanker)
  # По умолчанию: false (модель отключена)
  enabled: false
  
  # Путь к ONNX файлу модели для ранжирования
  # Определяет путь к файлу модели в формате ONNX
  # Модель должна быть обучена с использованием smoothtask_trainer.train_ranker
  # и экспортирована в формат ONNX
  # По умолчанию: "models/ranker.onnx" (относительный путь)
  # Для production рекомендуется использовать абсолютные пути
  model_path: "models/ranker.onnx"

