# SmoothTask — план задач

## Легенда статусов

- [ ] TODO       — задача ещё не делалась
- [~] IN PROGRESS — начата, но не завершена
- [x] DONE       — реализовано и покрыто тестами
- [!] BLOCKED    — есть блокер, нужна дополнительная информация

---

## 1. Ближайшие шаги (Next Up)

- [ ] ST-576: Улучшить документацию API для eBPF модуля
  - Тип: Documentation / API
  - Критерии готовности:
    - [ ] Создать подробную документацию для интеграции eBPF в другие модули
    - [ ] Документировать все публичные методы и структуры
    - [ ] Добавить примеры использования в документации
    - [ ] Обновить API_INTROSPECTION_RESEARCH.md с новой информацией
  - Примечания: Создание подробной документации для интеграции eBPF в другие модули
  - Приоритет: Высокий
  - Оценка времени: ~60 минут
  - Зависимости: Текущая реализация eBPF модуля

- [ ] ST-577: Добавить примеры использования eBPF в примерах кода
  - Тип: Documentation / Examples
  - Критерии готовности:
    - [ ] Создать примеры использования eBPF функциональности
    - [ ] Добавить примеры в директорию examples/
    - [ ] Документировать различные сценарии использования
    - [ ] Обновить README.md с ссылками на новые примеры
  - Примечания: Демонстрация различных сценариев использования eBPF функциональности
  - Приоритет: Средний
  - Оценка времени: ~45 минут
  - Зависимости: ST-576 (документация API)

- [ ] ST-578: Оптимизировать загрузку eBPF программ для уменьшения времени инициализации
  - Тип: Rust / core / metrics / eBPF
  - Критерии готовности:
    - [ ] Проанализировать текущее время загрузки eBPF программ
    - [ ] Оптимизировать процесс загрузки и инициализации
    - [ ] Добавить асинхронную загрузку где возможно
    - [ ] Добавить тесты для проверки производительности загрузки
  - Примечания: Улучшение производительности загрузки eBPF программ
  - Приоритет: Высокий
  - Оценка времени: ~90 минут
  - Зависимости: Текущая реализация eBPF модуля

## 2. Бэклог

- [ ] ST-579: Добавить поддержку мониторинга GPU через eBPF
  - Тип: Rust / core / metrics / eBPF / GPU
  - Примечания: Расширение eBPF функциональности для мониторинга GPU метрик
  - Приоритет: Низкий

- [ ] ST-580: Интегрировать eBPF метрики с системой уведомлений
  - Тип: Rust / core / notifications / eBPF
  - Примечания: Добавление уведомлений на основе eBPF метрик и событий
  - Приоритет: Низкий

## 3. Недавно сделано (Recently Done)

- [x] ST-575: Добавить поддержку дополнительных eBPF метрик (сетевые соединения, процесс-специфичные метрики)
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Расширение функциональности eBPF для более детального мониторинга
  - Статус: COMPLETED
  - Время выполнения: ~90 минут
  - Изменённые файлы:
    - smoothtask-core/src/ebpf_programs/network_connections.c: Создана новая eBPF программа для мониторинга сетевых соединений
    - smoothtask-core/src/ebpf_programs/process_monitor.c: Создана новая eBPF программа для мониторинга процесс-специфичных метрик
    - smoothtask-core/src/metrics/ebpf.rs: Добавлены новые структуры ConnectionStat и ProcessStat, обновлена конфигурация EbpfConfig, добавлены новые поля в EbpfMetrics, реализованы методы загрузки и сбора новых метрик
  - Результаты: Добавлена поддержка мониторинга сетевых соединений и процесс-специфичных метрик через eBPF, расширена функциональность существующего eBPF модуля, добавлены соответствующие тесты

- [x] ST-574: Оптимизировать использование памяти в eBPF модуле
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Улучшение производительности и уменьшение memory footprint
  - Статус: COMPLETED
  - Время выполнения: ~45 минут
  - Изменённые файлы:
    - smoothtask-core/src/metrics/ebpf.rs: Добавлены методы optimize_memory_usage, perform_memory_cleanup, optimize_detailed_stats, get_memory_usage_estimate
    - smoothtask-core/src/metrics/ebpf.rs: Добавлены поля max_cached_details, cleanup_unused_maps, cleanup_counter
    - smoothtask-core/src/metrics/ebpf.rs: Добавлены методы set_max_cached_details, set_cleanup_unused_maps
    - smoothtask-core/src/metrics/ebpf.rs: Добавлены тесты для оптимизации памяти
  - Результаты: Значительное уменьшение memory footprint, улучшенная производительность кэширования, добавлены тесты для проверки оптимизаций

- [x] ST-573: Добавить интеграционные тесты для eBPF модуля с реальными eBPF программами
  - Тип: Rust / core / metrics / eBPF / tests
  - Примечания: Повышение надежности eBPF функциональности через интеграционное тестирование
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Изменённые файлы:
    - smoothtask-core/src/ebpf_programs/test_cpu_metrics.c: Создана тестовая eBPF программа для CPU метрик
    - smoothtask-core/src/ebpf_programs/test_memory_metrics.c: Создана тестовая eBPF программа для метрик памяти
    - smoothtask-core/tests/ebpf_real_integration_test.rs: Добавлены интеграционные тесты для реального сбора данных
    - smoothtask-core/tests/ebpf_scenario_test.rs: Добавлены сценарийные тесты для различных сценариев использования
  - Результаты: Все тесты проходят, включая сценарии с отключенной eBPF поддержкой для CI/CD совместимости

- [x] ST-572: Улучшить документацию и комментарии в eBPF модуле
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Повышение читаемости и поддерживаемости кода
  - Статус: COMPLETED
  - Время выполнения: ~20 минут
  - Изменённые файлы:
    - smoothtask-core/src/metrics/ebpf.rs: Улучшена документация модуля, добавлены подробные комментарии к ключевым функциям
  - Результаты: Значительное улучшение документации и читаемости кода

- [x] ST-571: Заменить placeholder реализации на реальный сбор данных
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Завершение реализации реального сбора данных из eBPF
  - Статус: COMPLETED
  - Время выполнения: ~45 минут
  - Изменённые файлы:
    - smoothtask-core/src/metrics/ebpf.rs: Заменены все placeholder методы на реальные реализации с использованием iterate_ebpf_map_keys
  - Результаты: Полная реализация сбора данных из eBPF карт с улучшенной производительностью и надежностью

- [x] ST-570: Исправить дублирующиеся методы в eBPF модуле
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Улучшение качества кода и устранение дубликатов методов
  - Статус: COMPLETED
  - Время выполнения: ~30 минут
  - Изменённые файлы:
    - smoothtask-core/src/metrics/ebpf.rs: Удалены дублирующиеся placeholder методы, сохранены реальные реализации
  - Результаты: Улучшенное качество кода, устранение дубликатов, сохранение функциональности

- [x] ST-569: Оптимизировать производительность сбора eBPF метрик
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Повышение эффективности сбора eBPF метрик через параллельную обработку и улучшенное кэширование
  - Статус: COMPLETED
  - Время выполнения: ~25 минут
  - Изменённые файлы:
    - smoothtask-core/src/metrics/ebpf.rs: Добавлен метод collect_detailed_stats_parallel, оптимизирован collect_real_ebpf_metrics
  - Результаты: Значительное улучшение производительности сбора eBPF метрик

- [x] ST-568: Улучшить обработку ошибок и логирование в eBPF модуле
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Повышение надежности и отказоустойчивости eBPF функциональности с улучшенной диагностикой
  - Статус: COMPLETED
  - Время выполнения: ~30 минут
  - Изменённые файлы:
    - smoothtask-core/src/metrics/ebpf.rs: Улучшена обработка ошибок, добавлены методы get_detailed_error_info, has_errors, attempt_recovery
  - Результаты: Более надежная eBPF функциональность с улучшенной диагностикой и восстановлением

- [x] ST-572: Улучшить документацию и комментарии в eBPF модуле
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Повышение читаемости и поддерживаемости кода
  - Статус: COMPLETED
  - Время выполнения: ~20 минут
  - Изменённые файлы:
    - smoothtask-core/src/metrics/ebpf.rs: Улучшена документация модуля, добавлены подробные комментарии к ключевым функциям
  - Результаты: Значительное улучшение документации и читаемости кода

- [x] ST-571: Заменить placeholder реализации на реальный сбор данных
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Завершение реализации реального сбора данных из eBPF
  - Статус: COMPLETED
  - Время выполнения: ~45 минут
  - Изменённые файлы:
    - smoothtask-core/src/metrics/ebpf.rs: Заменены все placeholder методы на реальные реализации с использованием iterate_ebpf_map_keys
  - Результаты: Полная реализация сбора данных из eBPF карт с улучшенной производительностью и надежностью

- [x] ST-570: Исправить дублирующиеся методы в eBPF модуле
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Улучшение качества кода и устранение дубликатов методов
  - Статус: COMPLETED
  - Время выполнения: ~30 минут
  - Изменённые файлы:
    - smoothtask-core/src/metrics/ebpf.rs: Удалены дублирующиеся placeholder методы, сохранены реальные реализации
  - Результаты: Улучшенное качество кода, устранение дубликатов, сохранение функциональности

- [x] ST-569: Оптимизировать производительность сбора eBPF метрик
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Повышение эффективности сбора eBPF метрик через параллельную обработку и улучшенное кэширование
  - Статус: COMPLETED
  - Время выполнения: ~25 минут
  - Изменённые файлы:
    - smoothtask-core/src/metrics/ebpf.rs: Добавлен метод collect_detailed_stats_parallel, оптимизирован collect_real_ebpf_metrics
  - Результаты: Значительное улучшение производительности сбора eBPF метрик

- [x] ST-568: Улучшить обработку ошибок и логирование в eBPF модуле
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Повышение надежности и отказоустойчивости eBPF функциональности с улучшенной диагностикой
  - Статус: COMPLETED
  - Время выполнения: ~30 минут
  - Изменённые файлы:
    - smoothtask-core/src/metrics/ebpf.rs: Улучшена обработка ошибок, добавлены методы get_detailed_error_info, has_errors, attempt_recovery
  - Результаты: Более надежная eBPF функциональность с улучшенной диагностикой и восстановлением

См. архив: docs/history/PLAN_DONE_archive.md

## 4. Блокеры

- [!] ST-099: Вернуть зависимость onnxruntime, когда появится стабильная версия с нужными фичами
  - Нужны: релиз onnxruntime с требуемыми возможностями.