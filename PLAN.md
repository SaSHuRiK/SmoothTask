# SmoothTask — план задач

## Легенда статусов

- [ ] TODO       — задача ещё не делалась
- [~] IN PROGRESS — начата, но не завершена
- [x] DONE       — реализовано и покрыто тестами
- [!] BLOCKED    — есть блокер, нужна дополнительная информация

---

## 1. Ближайшие шаги (Next Up)

- [x] ST-770: Реализовать расширенный мониторинг сетевой активности процессов
  - Тип: Rust / core / metrics / network
  - Примечания: Добавление детального мониторинга сетевых соединений и трафика
  - Приоритет: Высокий
  - Оценка времени: ~90 минут
  - Критерии готовности:
    - [x] Исследовать доступные источники данных (/proc/net, eBPF, netlink)
    - [x] Реализовать сбор метрик сетевой активности на уровне процессов
    - [x] Добавить поддержку TCP/UDP статистики и соединений
    - [x] Интегрировать с существующей системой метрик
    - [x] Добавить тесты для нового функционала
  - Ожидаемые результаты: Более точный мониторинг сетевой активности для оптимизации политик
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Результаты:
    - Создан новый модуль process_network.rs с полным API для мониторинга сетевой активности процессов
    - Реализованы функции чтения из /proc/net/tcp и /proc/net/udp
    - Добавлены структуры ProcessNetworkStats и ProcessConnectionStats
    - Интегрировано с существующими структурами ProcessRecord и AppGroupRecord
    - Добавлены comprehensive тесты для нового функционала
    - Реализована поддержка кэширования и бенчмаркинга
  - Изменённые файлы:
    - smoothtask-core/src/metrics/process_network.rs: Новый модуль (34KB)
    - smoothtask-core/src/metrics/mod.rs: Добавлен новый модуль
    - smoothtask-core/src/logging/snapshots.rs: Добавлены сетевые поля
    - smoothtask-core/src/classify/grouper.rs: Обновлена инициализация AppGroupRecord
    - smoothtask-core/src/metrics/process.rs: Обновлена инициализация ProcessRecord

- [ ] ST-771: Улучшить систему автоматического обнаружения приложений
  - Тип: Rust / core / classify / detection
  - Примечания: Улучшение алгоритмов обнаружения и классификации приложений
  - Приоритет: Высокий
  - Оценка времени: ~60 минут
  - Критерии готовности:
    - [ ] Улучшить эвристики обнаружения приложений
    - [ ] Добавить поддержку обнаружения по исполняемым файлам и аргументам
    - [ ] Улучшить обработку сложных случаев (контейнеры, sandbox)
    - [ ] Добавить тесты для новых алгоритмов обнаружения
  - Ожидаемые результаты: Более точное и надежное обнаружение приложений

- [ ] ST-772: Реализовать систему мониторинга здоровья демона
  - Тип: Rust / core / monitoring / health
  - Примечания: Добавление системы мониторинга здоровья и диагностики
  - Приоритет: Средний
  - Оценка времени: ~60 минут
  - Критерии готовности:
    - [ ] Реализовать сбор метрик здоровья демона
    - [ ] Добавить систему диагностики и логирования проблем
    - [ ] Реализовать уведомления о критических состояниях
    - [ ] Добавить тесты для системы мониторинга здоровья
  - Ожидаемые результаты: Более надежная и отказоустойчивая работа демона

- [ ] ST-773: Улучшить систему логирования и анализа производительности
  - Тип: Rust / core / logging / performance
  - Примечания: Оптимизация системы логирования для высокой нагрузки
  - Приоритет: Средний
  - Оценка времени: ~45 минут
  - Критерии готовности:
    - [ ] Проанализировать текущие узкие места в логировании
    - [ ] Реализовать асинхронное логирование с буферизацией
    - [ ] Добавить поддержку уровней логирования и фильтрации
    - [ ] Добавить тесты для проверки производительности
  - Ожидаемые результаты: Более эффективная система логирования с меньшей нагрузкой

- [ ] ST-774: Реализовать поддержку мониторинга GPU для процессов
  - Тип: Rust / core / metrics / gpu
  - Примечания: Добавление мониторинга использования GPU на уровне процессов
  - Приоритет: Средний
  - Оценка времени: ~60 минут
  - Критерии готовности:
    - [ ] Исследовать доступные источники данных (nvidia-smi, AMD, Intel)
    - [ ] Реализовать сбор метрик использования GPU
    - [ ] Интегрировать с существующей системой метрик
    - [ ] Добавить тесты для нового функционала
  - Ожидаемые результаты: Более полный мониторинг ресурсов для GPU-интенсивных приложений

- [ ] ST-775: Обновить все тестовые случаи с новыми сетевыми полями
  - Тип: Rust / core / testing
  - Примечания: Обновление всех тестовых случаев после добавления сетевых метрик
  - Приоритет: Средний
  - Оценка времени: ~45 минут
  - Критерии готовности:
    - [ ] Обновить тесты в actuator.rs
    - [ ] Обновить тесты в api/server.rs
    - [ ] Обновить тесты в classify/grouper.rs
    - [ ] Обновить тесты в classify/ml_classifier.rs
    - [ ] Обновить тесты в classify/rules.rs
    - [ ] Обновить тесты в logging/snapshots.rs
    - [ ] Обновить тесты в metrics/app_performance.rs
    - [ ] Обновить тесты в metrics/process.rs
    - [ ] Обновить тесты в model/features.rs
  - Ожидаемые результаты: Все тесты проходят успешно с новыми сетевыми полями

## 2. Бэклог

- [ ] ST-740: Реализовать расширенный мониторинг энергопотребления процессов
  - Тип: Rust / core / metrics / energy
  - Примечания: Добавление мониторинга энергопотребления на уровне процессов
  - Приоритет: Средний
  - Статус: TODO
  - Оценка времени: ~60 минут
  - Критерии готовности:
    - [ ] Исследовать доступные источники данных (RAPL, eBPF, sysfs)
    - [ ] Реализовать сбор метрик энергопотребления
    - [ ] Интегрировать с существующей системой метрик
    - [ ] Добавить тесты для нового функционала
  - Ожидаемые результаты: Расширенный мониторинг энергопотребления для оптимизации политик

- [ ] ST-741: Улучшить интеграцию с Wayland для мониторинга окон
  - Тип: Rust / core / metrics / windows
  - Примечания: Улучшение поддержки Wayland для интроспекции окон и приложений
  - Приоритет: Средний
  - Статус: TODO
  - Оценка времени: ~90 минут
  - Критерии готовности:
    - [ ] Исследовать Wayland протоколы для интроспекции
    - [ ] Реализовать поддержку основных композиторов (KWin, Mutter, Sway)
    - [ ] Интегрировать с существующей системой классификации
    - [ ] Добавить тесты для нового функционала
  - Ожидаемые результаты: Полноценная поддержка Wayland для мониторинга окон

- [ ] ST-743: Добавить поддержку мониторинга дискового ввода-вывода на уровне процессов
  - Тип: Rust / core / metrics / io
  - Примечания: Расширенный мониторинг операций ввода-вывода для процессов
  - Приоритет: Средний
  - Статус: TODO
  - Оценка времени: ~60 минут
  - Критерии готовности:
    - [ ] Исследовать доступные источники данных (/proc, eBPF, io_uring)
    - [ ] Реализовать сбор метрик дискового ввода-вывода
    - [ ] Интегрировать с существующей системой метрик
    - [ ] Добавить тесты для нового функционала
  - Ожидаемые результаты: Более точный мониторинг дисковой активности

- [ ] ST-744: Улучшить систему автоматического обновления конфигурации
  - Тип: Rust / core / config / auto-update
  - Примечания: Автоматическое обновление конфигурации и паттернов без перезапуска
  - Приоритет: Средний
  - Статус: TODO
  - Оценка времени: ~90 минут
  - Критерии готовности:
    - [ ] Реализовать механизм наблюдения за файлами конфигурации
    - [ ] Добавить горячую перезагрузку паттернов и политик
    - [ ] Реализовать уведомления об изменениях конфигурации
    - [ ] Добавить тесты для нового функционала
  - Ожидаемые результаты: Более гибкая система управления конфигурацией

## 3. Недавно сделано (Recently Done)

- [x] ST-770: Реализовать расширенный мониторинг сетевой активности процессов
  - Тип: Rust / core / metrics / network
  - Примечания: Добавление детального мониторинга сетевых соединений и трафика
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Результаты:
    - Создан новый модуль process_network.rs с полным API для мониторинга сетевой активности процессов
    - Реализованы функции чтения из /proc/net/tcp и /proc/net/udp
    - Добавлены структуры ProcessNetworkStats и ProcessConnectionStats
    - Интегрировано с существующими структурами ProcessRecord и AppGroupRecord
    - Добавлены comprehensive тесты для нового функционала
    - Реализована поддержка кэширования и бенчмаркинга
  - Изменённые файлы:
    - smoothtask-core/src/metrics/process_network.rs: Новый модуль (34KB)
    - smoothtask-core/src/metrics/mod.rs: Добавлен новый модуль
    - smoothtask-core/src/logging/snapshots.rs: Добавлены сетевые поля
    - smoothtask-core/src/classify/grouper.rs: Обновлена инициализация AppGroupRecord
    - smoothtask-core/src/metrics/process.rs: Обновлена инициализация ProcessRecord

- [x] ST-768: Завершить и протестировать улучшения API обработки ошибок
  - Тип: Rust / core / api / testing
  - Примечания: Завершение рефакторинга обработки ошибок в API сервере
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Результаты:
    - Реализована унифицированная система обработки ошибок через ApiError
    - Улучшены обработчики процессов и групп приложений с использованием ApiError
    - Улучшена обработка ошибок валидации, не найдено, недоступности сервиса
    - Улучшены сообщения об ошибках и HTTP статусы
    - Все тесты проходят успешно
  - Изменённые файлы:
    - smoothtask-core/src/api/server.rs: Полная рефакторизация обработки ошибок

- [x] ST-767: Оптимизировать производительность критических путей
  - Тип: Performance / Optimization
  - Примечания: Профилирование и оптимизация производительности
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Результаты:
    - Оптимизирован сбор метрик процессов: уменьшено количество блокировок кэша и улучшена параллельная обработка
    - Добавлена поддержка пакетной обработки в системе логирования для уменьшения накладных расходов
    - Улучшена обработка кэша с уменьшением контенции на блокировках
    - Добавлены оптимизации для уменьшения накладных расходов на логирование
    - Все тесты проходят успешно
  - Изменённые файлы:
    - smoothtask-core/src/metrics/process.rs: Оптимизация параллельной обработки и кэширования
    - smoothtask-core/src/logging/log_storage.rs: Добавлена пакетная обработка записей

- [x] ST-766: Обновить документацию с учетом всех последних изменений
  - Тип: Documentation / API
  - Примечания: Обновление документации для новых функций и изменений API
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~90 минут
  - Результаты:
    - Обновлена API.md с унифицированной системой обработки ошибок
    - Добавлена документация для AppLogRotator и LogStorage
    - Добавлена документация для метрик энергопотребления процессов с RAPL
    - Добавлена документация для поддержки Wayland композиторов (включая Wayfire)
    - Созданы новые файлы документации: LOGGING_ROTATION.md и WAYLAND_COMPOSITOR_SUPPORT.md
  - Изменённые файлы:
    - docs/API.md: Обновлена система обработки ошибок
    - docs/METRICS.md: Добавлены метрики энергопотребления процессов
    - docs/LOGGING_ROTATION.md: Новая документация для системы логирования
    - docs/WAYLAND_COMPOSITOR_SUPPORT.md: Новая документация для Wayland поддержки

- [x] ST-764: Улучшить поддержку Wayland для различных композиторов
  - Тип: Rust / core / metrics / windows
  - Примечания: Расширение поддержки Wayland композиторов
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Результаты:
    - Добавлена поддержка Wayfire композитора в detect_wayland_compositor()
    - Улучшена обработка ошибок с учетом специфики Wayfire
    - Добавлены comprehensive тесты для Wayfire
    - Обновлена документация и примеры
  - Изменённые файлы:
    - smoothtask-core/src/metrics/windows_wayland.rs: Добавлена поддержка Wayfire

- [x] ST-742: Оптимизировать использование памяти в системе логирования
  - Тип: Rust / core / logging / optimization
  - Примечания: Улучшение управления памятью в системе логирования и снапшотов
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~45 минут
  - Результаты:
    - Реализована очистка по памяти с оценкой использования
    - Добавлены функции cleanup_by_memory() и estimate_memory_usage()
    - Реализована memory-aware версия add_entry_with_memory_check()
    - Добавлены comprehensive тесты для нового функционала
    - Интегрировано с системой мониторинга и health status
  - Изменённые файлы:
    - smoothtask-core/src/logging/log_storage.rs: Полная реализация memory optimization

*(Более старые выполненные задачи перенесены в архив: docs/history/PLAN_DONE_archive.md)*

## 4. Блокеры

*(На данный момент нет активных блокеров)*
