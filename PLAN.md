# SmoothTask — план задач

## Легенда статусов

- [ ] TODO       — задача ещё не делалась
- [~] IN PROGRESS — начата, но не завершена
- [x] DONE       — реализовано и покрыто тестами
- [!] BLOCKED    — есть блокер, нужна дополнительная информация

---

## 1. Ближайшие шаги (Next Up)

- [x] ST-633: Добавить поддержку мониторинга температуры процессора через eBPF
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Реализация мониторинга температуры процессора с использованием eBPF
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Критерии готовности:
    - ✅ eBPF программа для мониторинга температуры процессора (cpu_temperature.c)
    - ✅ Интеграция с системными метриками в ebpf.rs
    - ✅ Новый API endpoint /api/cpu/temperature с обработчиком cpu_temperature_handler
    - ✅ Комплексные тесты для нового функционала (ebpf_integration_test.rs, api_integration_test.rs)
    - ✅ Конфигурация enable_cpu_temperature_monitoring в EbpfConfig
    - ✅ Структура CpuTemperatureStat для хранения детализированной статистики
    - ✅ Функции collect_cpu_temperature_data и collect_cpu_temperature_from_maps
    - ✅ Кэширование и обработка ошибок
  - Изменённые файлы:
    - smoothtask-core/src/ebpf_programs/cpu_temperature.c: eBPF программа для мониторинга температуры CPU
    - smoothtask-core/src/metrics/ebpf.rs: Интеграция мониторинга температуры CPU с eBPF
    - smoothtask-core/src/api/server.rs: Добавлен обработчик cpu_temperature_handler и маршрут /api/cpu/temperature
    - smoothtask-core/tests/ebpf_integration_test.rs: Комплексные тесты для функционала мониторинга температуры CPU
    - smoothtask-core/tests/api_integration_test.rs: Тесты для API endpoint температуры CPU
  - Результаты: Полная реализация мониторинга температуры процессора через eBPF с поддержкой детализированной статистики по каждому CPU ядру, API endpoint для мониторинга и комплексными тестами

## 2. Бэклог

## 3. Недавно сделано (Recently Done)

- [x] ST-641: Исправить предупреждения компилятора (unused variables и useless comparisons)
  - Тип: Rust / core / code quality
  - Примечания: Исправление предупреждений компилятора для улучшения качества кода
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~30 минут
  - Критерии готовности:
    - ✅ Исправление unused переменных в audio.rs (тест graceful degradation)
    - ✅ Исправление unused переменных в ebpf.rs (process_gpu_details, process_network_details, process_disk_details)
    - ✅ Исправление useless comparisons для unsigned типов (u64, usize)
    - ✅ Проверка успешной компиляции без предупреждений
  - Изменённые файлы:
    - smoothtask-core/src/metrics/audio.rs: Исправлена unused переменная в тесте
    - smoothtask-core/src/metrics/ebpf.rs: Исправлены unused переменные и useless comparisons
  - Результаты: Успешная компиляция без предупреждений, улучшенное качество кода

- [x] ST-633: Добавить поддержку мониторинга температуры процессора через eBPF
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Реализация мониторинга температуры процессора с использованием eBPF
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Критерии готовности:
    - ✅ eBPF программа для мониторинга температуры процессора (cpu_temperature.c)
    - ✅ Интеграция с системными метриками в ebpf.rs
    - ✅ Новый API endpoint /api/cpu/temperature с обработчиком cpu_temperature_handler
    - ✅ Комплексные тесты для нового функционала
    - ✅ Конфигурация enable_cpu_temperature_monitoring в EbpfConfig
    - ✅ Структура CpuTemperatureStat для хранения детализированной статистики
    - ✅ Кэширование и обработка ошибок
  - Изменённые файлы:
    - smoothtask-core/src/ebpf_programs/cpu_temperature.c: eBPF программа для мониторинга температуры CPU
    - smoothtask-core/src/metrics/ebpf.rs: Интеграция мониторинга температуры CPU с eBPF
    - smoothtask-core/src/api/server.rs: Добавлен обработчик cpu_temperature_handler и маршрут /api/cpu/temperature
    - smoothtask-core/tests/ebpf_integration_test.rs: Комплексные тесты для функционала мониторинга температуры CPU
    - smoothtask-core/tests/api_integration_test.rs: Тесты для API endpoint температуры CPU
  - Результаты: Полная реализация мониторинга температуры процессора через eBPF с поддержкой детализированной статистики по каждому CPU ядру, API endpoint для мониторинга и комплексными тестами

- [x] ST-639: Обновить документацию API с последними изменениями
  - Тип: Documentation / API
  - Примечания: Добавление документации для missing API endpoint
  - Приоритет: Низкий
  - Статус: COMPLETED
  - Время выполнения: ~45 минут
  - Критерии готовности:
    - ✅ Добавление документации для 5 новых API endpoint
    - ✅ Обновление примеров использования
    - ✅ Проверка соответствия документации реальной реализации
  - Изменённые файлы:
    - docs/API.md: Добавлена документация для /api/performance, /api/processes/disk, /api/processes/energy, /api/processes/memory, /api/processes/network
  - Результаты: Полная и актуальная документация API

- [x] ST-638: Улучшить качество кода - исправить предупреждения компилятора
  - Тип: Rust / core / code quality
  - Примечания: Исправление предупреждений компилятора
  - Приоритет: Низкий
  - Статус: COMPLETED
  - Время выполнения: ~20 минут
  - Критерии готовности:
    - ✅ Исправление всех предупреждений unused imports
    - ✅ Исправление всех предупреждений unused variables
    - ✅ Исправление всех предупреждений unused mut
    - ✅ Проверка успешной компиляции без предупреждений
  - Изменённые файлы:
    - smoothtask-core/src/api/server.rs: Удален unused import SystemMetrics
    - smoothtask-core/src/metrics/audio.rs: Исправлены unused mut и unused variables
  - Результаты: Успешная компиляция без предупреждений, улучшенное качество кода

- [x] ST-637: Исправить ошибки компиляции после добавления мониторинга диска процессов
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Исправление ошибок компиляции и тестов после добавления нового функционала
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~90 минут
  - Критерии готовности:
    - ✅ Добавление missing поля process_disk_details в EbpfMetrics инициализацию
    - ✅ Добавление missing поля enable_process_disk_monitoring в EbpfConfig инициализацию
    - ✅ Исправление всех вызовов optimize_detailed_stats с добавлением process_disk_details параметра
    - ✅ Исправление всех тестов с добавлением missing полей в EbpfMetrics инициализацию
    - ✅ Исправление импортов в тестах
    - ✅ Исправление ошибок типов в API обработчиках
  - Изменённые файлы:
    - smoothtask-core/src/metrics/ebpf.rs: Исправления компиляции и тестов
    - smoothtask-core/src/api/server.rs: Исправления компиляции и тестов
    - smoothtask-core/tests/ebpf_mock_test.rs: Добавление missing полей
    - smoothtask-core/src/metrics/system.rs: Добавление missing полей
  - Результаты: Успешная компиляция и прохождение тестов после добавления нового функционала мониторинга диска процессов

- [x] ST-631: Добавить поддержку мониторинга использования диска на уровне процессов
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Реализация детализированного мониторинга дискового ввода-вывода процессами с использованием eBPF
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~90 минут
  - Критерии готовности:
    - ✅ eBPF программа для мониторинга дискового ввода-вывода процессов (process_disk.c)
    - ✅ Интеграция с существующими метриками процессов
    - ✅ Новый API endpoint /api/processes/disk с обработчиком process_disk_handler
    - ✅ Комплексные тесты для нового функционала
    - ✅ Конфигурация enable_process_disk_monitoring в EbpfConfig
    - ✅ Структура ProcessDiskStat для хранения статистики
    - ✅ Функция collect_process_disk_stats для сбора данных
    - ✅ Кэширование и обработка ошибок
  - Изменённые файлы:
    - smoothtask-core/src/ebpf_programs/process_disk.c: Новая eBPF программа для мониторинга дисковой активности процессов
    - smoothtask-core/src/metrics/ebpf.rs: Добавлена поддержка мониторинга дисковой активности процессов
    - smoothtask-core/src/api/server.rs: Добавлен обработчик process_disk_handler и маршрут /api/processes/disk
    - smoothtask-core/examples/ebpf_example.rs: Добавлена конфигурация enable_process_disk_monitoring
  - Результаты: Полная реализация мониторинга дисковой активности процессов через eBPF с поддержкой детализированной статистики по каждому процессу, API endpoint для мониторинга и комплексными тестами

- [x] ST-630: Добавить документацию API для мониторинга использования GPU процессами
  - Тип: Documentation / API
  - Примечания: Документирование нового API endpoint /api/processes/gpu с примерами использования
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~30 минут
  - Критерии готовности:
    - ✅ Документация API с описанием endpoint, параметров и формата ответа
    - ✅ Примеры использования в формате curl
    - ✅ Интеграция документации в основной API.md файл
    - ✅ Примеры ошибок и их обработки
    - ✅ Обновление документации в соответствии с реальной реализацией
  - Изменённые файлы:
    - docs/API.md: Обновлена документация для /api/processes/gpu endpoint
  - Результаты: Полная документация API для мониторинга использования GPU процессами с примерами использования и обработки ошибок

- [x] ST-629: Улучшить обработку ошибок в модуле метрик ввода
  - Тип: Rust / core / metrics
  - Примечания: Добавление более детальных сообщений об ошибках и улучшение graceful degradation для метрик ввода
  - Приоритет: Низкий
  - Статус: COMPLETED
  - Время выполнения: ~30 минут
  - Критерии готовности:
    - ✅ Улучшенные сообщения об ошибках с практическими рекомендациями
    - ✅ Graceful degradation при недоступности устройств ввода
    - ✅ Подсчет и логирование ошибок для диагностики
    - ✅ Частичное восстановление при ошибках в отдельных устройствах
  - Изменённые файлы:
    - smoothtask-core/src/metrics/input.rs: Улучшенная обработка ошибок с детальными сообщениями и счетчиком ошибок
  - Результаты: Полная реализация улучшенной обработки ошибок с детальными сообщениями, улучшенной диагностикой и graceful degradation для метрик ввода

- [x] ST-628: Добавить поддержку мониторинга использования сети на уровне процессов
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Реализация детализированного мониторинга сетевого трафика процессами с использованием eBPF
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~90 минут
  - Критерии готовности:
    - ✅ eBPF программа для мониторинга сетевого трафика процессов (process_network.c)
    - ✅ Интеграция с существующими метриками процессов
    - ✅ Новый API endpoint /api/processes/network с обработчиком process_network_handler
    - ✅ Комплексные тесты для нового функционала
    - ✅ Конфигурация enable_process_network_monitoring в EbpfConfig
    - ✅ Структура ProcessNetworkStat для хранения статистики
    - ✅ Функция collect_process_network_stats для сбора данных
    - ✅ Кэширование и обработка ошибок
  - Изменённые файлы:
    - smoothtask-core/src/ebpf_programs/process_network.c: Новая eBPF программа для мониторинга сетевого трафика процессов
    - smoothtask-core/src/metrics/ebpf.rs: Добавлена поддержка мониторинга сетевого трафика процессов
    - smoothtask-core/src/api/server.rs: Добавлен обработчик process_network_handler и маршрут /api/processes/network
    - smoothtask-core/examples/ebpf_example.rs: Добавлена конфигурация enable_process_network_monitoring
  - Результаты: Полная реализация мониторинга сетевого трафика процессов через eBPF с поддержкой детализированной статистики по каждому процессу, API endpoint для мониторинга и комплексными тестами

- [x] ST-626: Улучшить обработку ошибок в модуле метрик аудио
  - Тип: Rust / core / metrics
  - Примечания: Добавление более детальных сообщений об ошибках и улучшение graceful degradation для аудио метрик
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~45 минут
  - Критерии готовности:
    - ✅ Улучшенные сообщения об ошибках с практическими рекомендациями
    - ✅ Graceful degradation при недоступности аудио компонентов
    - ✅ Подсчет и логирование ошибок для диагностики
    - ✅ Частичное восстановление при ошибках в отдельных устройствах
  - Результаты: Полная реализация улучшенной обработки ошибок с детальными сообщениями и улучшенной диагностикой для аудио метрик

- [x] ST-619: Добавить поддержку мониторинга энергопотребления процессов
  - Тип: Rust / core / metrics / eBPF
  - Примечания: Реализация мониторинга энергопотребления на уровне процессов с использованием eBPF
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~90 минут
  - Критерии готовности:
    - ✅ eBPF программа для мониторинга энергопотребления процессов (process_energy.c)
    - ✅ Интеграция с метриками в ebpf.rs (ProcessEnergyStat, конфигурация, сбор данных)
    - ✅ Новый API endpoint /api/processes/energy с обработчиком process_energy_handler
    - ✅ Комплексные тесты для нового функционала (тесты eBPF и API)
    - ✅ Документация API с примерами использования
  - Изменённые файлы:
    - smoothtask-core/src/ebpf_programs/process_energy.c: Новая eBPF программа для мониторинга энергопотребления процессов
    - smoothtask-core/src/metrics/ebpf.rs: Добавлена поддержка мониторинга энергопотребления процессов
    - smoothtask-core/src/api/server.rs: Добавлен обработчик process_energy_handler и маршрут /api/processes/energy
    - smoothtask-core/src/metrics/ebpf.rs: Добавлены комплексные тесты для функционала
    - smoothtask-core/src/api/server.rs: Добавлены тесты для API endpoint
  - Результаты: Полная реализация мониторинга энергопотребления процессов через eBPF с поддержкой детализированной статистики по каждому процессу, API endpoint для мониторинга и комплексными тестами

*(Более старые выполненные задачи перенесены в архив: docs/history/PLAN_DONE_archive.md)*

См. архив: docs/history/PLAN_DONE_archive.md

## 4. Блокеры

- [!] ST-099: Вернуть зависимость onnxruntime, когда появится стабильная версия с нужными фичами
  - Нужны: релиз onnxruntime с требуемыми возможностями.
