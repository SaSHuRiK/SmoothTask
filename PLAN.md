# SmoothTask — план задач

## Легенда статусов

- [ ] TODO       — задача ещё не делалась
- [~] IN PROGRESS — начата, но не завершена
- [x] DONE       — реализовано и покрыто тестами
- [!] BLOCKED    — есть блокер, нужна дополнительная информация

---

## 1. Ближайшие шаги (Next Up)

- [x] ST-765: Провести комплексное тестирование и валидацию текущей реализации
  - Тип: Testing / Validation / Integration
  - Примечания: Полное тестирование всех новых функций и интеграций
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Критерии готовности:
    - [x] Провести интеграционное тестирование всех новых модулей
    - [x] Проверить совместимость между различными компонентами
    - [x] Выполнить стресс-тестирование системы логирования и ротации
    - [x] Проверить работу с различными конфигурациями
    - [x] Документировать результаты тестирования
  - Ожидаемые результаты: Полностью протестированная и валидированная система
  - Результаты:
    - Исправлены ошибки в API обработчиках для корректной обработки ошибок
    - Исправлены тесты для проверки обработки ошибок "не найдено"
    - Исправлены тесты для проверки кэширования
    - Исправлены тесты для проверки мониторинга кэша
    - Обновлена система обработки ошибок для возврата правильных HTTP статусов
    - Все основные тесты проходят успешно

- [x] ST-766: Обновить документацию с учетом всех последних изменений
  - Тип: Documentation / API
  - Примечания: Обновление документации для новых функций и изменений API
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~90 минут
  - Критерии готовности:
    - [x] Обновить API.md с новыми функциями и структурами
    - [x] Добавить документацию для новых модулей (app_rotation, energy monitoring)
    - [x] Добавить документацию для поддержки Wayland композиторов
    - [x] Обновить примеры конфигураций
    - [x] Добавить информацию о новых возможностях в README
  - Ожидаемые результаты: Полная и актуальная документация
  - Результаты:
    - Обновлена API.md с унифицированной системой обработки ошибок
    - Добавлена документация для AppLogRotator и LogStorage
    - Добавлена документация для метрик энергопотребления процессов с RAPL
    - Добавлена документация для поддержки Wayland композиторов (включая Wayfire)
    - Созданы новые файлы документации: LOGGING_ROTATION.md и WAYLAND_COMPOSITOR_SUPPORT.md
  - Изменённые файлы:
    - docs/API.md: Обновлена система обработки ошибок
    - docs/METRICS.md: Добавлены метрики энергопотребления процессов
    - docs/LOGGING_ROTATION.md: Новая документация для системы логирования
    - docs/WAYLAND_COMPOSITOR_SUPPORT.md: Новая документация для Wayland поддержки

- [x] ST-768: Завершить и протестировать улучшения API обработки ошибок
  - Тип: Rust / core / api / testing
  - Примечания: Завершение рефакторинга обработки ошибок в API сервере
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Критерии готовности:
    - [x] Проверить все обработчики на использование ApiError
    - [x] Обновить тесты для проверки новых обработчиков ошибок
    - [x] Убедиться в корректной работе всех HTTP статусов
    - [x] Проверить интеграцию с существующими клиентами
  - Ожидаемые результаты: Консистентная и надежная обработка ошибок в API
  - Результаты:
    - Реализована унифицированная система обработки ошибок через ApiError
    - Улучшены обработчики процессов и групп приложений с использованием ApiError
    - Улучшена обработка ошибок валидации, не найдено, недоступности сервиса
    - Улучшены сообщения об ошибках и HTTP статусы
    - Все тесты проходят успешно
  - Изменённые файлы:
    - smoothtask-core/src/api/server.rs: Полная рефакторизация обработки ошибок

- [x] ST-767: Оптимизировать производительность критических путей
  - Тип: Performance / Optimization
  - Примечания: Профилирование и оптимизация производительности
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Критерии готовности:
    - [x] Провести профилирование основных функций
    - [x] Оптимизировать сбор метрик и классификацию
    - [x] Улучшить производительность системы логирования
    - [x] Проверить использование памяти и CPU
  - Ожидаемые результаты: Более эффективная и быстрая работа системы
  - Результаты:
    - Оптимизирован сбор метрик процессов: уменьшено количество блокировок кэша и улучшена параллельная обработка
    - Добавлена поддержка пакетной обработки в системе логирования для уменьшения накладных расходов
    - Улучшена обработка кэша с уменьшением контенции на блокировках
    - Добавлены оптимизации для уменьшения накладных расходов на логирование
    - Все тесты проходят успешно
  - Изменённые файлы:
    - smoothtask-core/src/metrics/process.rs: Оптимизация параллельной обработки и кэширования
    - smoothtask-core/src/logging/log_storage.rs: Добавлена пакетная обработка записей

- [x] ST-765: Провести комплексное тестирование и валидацию текущей реализации
  - Тип: Testing / Validation / Integration
  - Примечания: Полное тестирование всех новых функций и интеграций
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Результаты:
    - Исправлены ошибки в API обработчиках для корректной обработки ошибок
    - Исправлены тесты для проверки обработки ошибок "не найдено"
    - Исправлены тесты для проверки кэширования
    - Исправлены тесты для проверки мониторинга кэша
    - Обновлена система обработки ошибок для возврата правильных HTTP статусов
    - Все основные тесты проходят успешно
  - Изменённые файлы:
    - smoothtask-core/src/api/server.rs: Исправлены обработчики процессов и групп приложений
    - smoothtask-core/src/api/server.rs: Исправлены тесты для проверки обработки ошибок
    - smoothtask-core/src/api/server.rs: Исправлены тесты для проверки кэширования



- [x] ST-768: Завершить и протестировать улучшения API обработки ошибок
  - Тип: Rust / core / api / testing
  - Примечания: Завершение рефакторинга обработки ошибок в API сервере
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Результаты:
    - Реализована унифицированная система обработки ошибок через ApiError
    - Улучшены обработчики процессов и групп приложений с использованием ApiError
    - Улучшена обработка ошибок валидации, не найдено, недоступности сервиса
    - Улучшены сообщения об ошибках и HTTP статусы
    - Все тесты проходят успешно
  - Изменённые файлы:
    - smoothtask-core/src/api/server.rs: Полная рефакторизация обработки ошибок

- [x] ST-764: Улучшить поддержку Wayland для различных композиторов
  - Тип: Rust / core / metrics / windows
  - Примечания: Расширение поддержки Wayland композиторов
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Критерии готовности:
    - [x] Добавить поддержку дополнительных композиторов (Hyprland, River, Wayfire)
    - [x] Улучшить обработку ошибок
    - [x] Добавить тесты для новых композиторов
  - Ожидаемые результаты: Более полная поддержка Wayland
  - Результаты:
    - Добавлена поддержка Wayfire композитора в detect_wayland_compositor()
    - Улучшена обработка ошибок с учетом специфики Wayfire
    - Добавлены comprehensive тесты для Wayfire
    - Обновлена документация и примеры
  - Изменённые файлы:
    - smoothtask-core/src/metrics/windows_wayland.rs: Добавлена поддержка Wayfire



- [x] ST-759: Улучшить систему логирования и ротации логов
  - Тип: Rust / core / logging / optimization
  - Примечания: Реализация ротации и очистки старых логов
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~90 минут
  - Результаты:
    - Добавлен новый модуль app_rotation.rs для ротации основных логов приложения
    - Расширен LogStorage с поддержкой ротации по времени и очистки по памяти
    - Интегрирована автоматическая ротация в основной цикл демона
    - Добавлены comprehensive тесты для нового функционала
    - Реализована оценка использования памяти и автоматическая очистка

## 2. Бэклог

- [ ] ST-740: Реализовать расширенный мониторинг энергопотребления процессов
  - Тип: Rust / core / metrics / energy
  - Примечания: Добавление мониторинга энергопотребления на уровне процессов
  - Приоритет: Средний
  - Статус: TODO
  - Оценка времени: ~60 минут
  - Критерии готовности:
    - [ ] Исследовать доступные источники данных (RAPL, eBPF, sysfs)
    - [ ] Реализовать сбор метрик энергопотребления
    - [ ] Интегрировать с существующей системой метрик
    - [ ] Добавить тесты для нового функционала
  - Ожидаемые результаты: Расширенный мониторинг энергопотребления для оптимизации политик

- [ ] ST-741: Улучшить интеграцию с Wayland для мониторинга окон
  - Тип: Rust / core / metrics / windows
  - Примечания: Улучшение поддержки Wayland для интроспекции окон и приложений
  - Приоритет: Средний
  - Статус: TODO
  - Оценка времени: ~90 минут
  - Критерии готовности:
    - [ ] Исследовать Wayland протоколы для интроспекции
    - [ ] Реализовать поддержку основных композиторов (KWin, Mutter, Sway)
    - [ ] Интегрировать с существующей системой классификации
    - [ ] Добавить тесты для нового функционала
  - Ожидаемые результаты: Полноценная поддержка Wayland для мониторинга окон

- [x] ST-742: Оптимизировать использование памяти в системе логирования
  - Тип: Rust / core / logging / optimization
  - Примечания: Улучшение управления памятью в системе логирования и снапшотов
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~45 минут
  - Критерии готовности:
    - [x] Проанализировать текущее использование памяти
    - [x] Реализовать ротацию и очистку старых логов
    - [x] Добавить лимиты на размер логов
    - [x] Добавить мониторинг использования памяти
  - Ожидаемые результаты: Более эффективное использование памяти в системе логирования
  - Результаты:
    - Реализована очистка по памяти с оценкой использования
    - Добавлены функции cleanup_by_memory() и estimate_memory_usage()
    - Реализована memory-aware версия add_entry_with_memory_check()
    - Добавлены comprehensive тесты для нового функционала
    - Интегрировано с системой мониторинга и health status
  - Изменённые файлы:
    - smoothtask-core/src/logging/log_storage.rs: Полная реализация memory optimization

- [ ] ST-743: Добавить поддержку мониторинга дискового ввода-вывода на уровне процессов
  - Тип: Rust / core / metrics / io
  - Примечания: Расширенный мониторинг операций ввода-вывода для процессов
  - Приоритет: Средний
  - Статус: TODO
  - Оценка времени: ~60 минут
  - Критерии готовности:
    - [ ] Исследовать доступные источники данных (/proc, eBPF, io_uring)
    - [ ] Реализовать сбор метрик дискового ввода-вывода
    - [ ] Интегрировать с существующей системой метрик
    - [ ] Добавить тесты для нового функционала
  - Ожидаемые результаты: Более точный мониторинг дисковой активности

- [ ] ST-744: Улучшить систему автоматического обновления конфигурации
  - Тип: Rust / core / config / auto-update
  - Примечания: Автоматическое обновление конфигурации и паттернов без перезапуска
  - Приоритет: Средний
  - Статус: TODO
  - Оценка времени: ~90 минут
  - Критерии готовности:
    - [ ] Реализовать механизм наблюдения за файлами конфигурации
    - [ ] Добавить горячую перезагрузку паттернов и политик
    - [ ] Реализовать уведомления об изменениях конфигурации
    - [ ] Добавить тесты для нового функционала
  - Ожидаемые результаты: Более гибкая система управления конфигурацией

## 3. Недавно сделано (Recently Done)

- [x] ST-763: Улучшить систему мониторинга энергопотребления
  - Тип: Rust / core / metrics / energy
  - Примечания: Расширение мониторинга энергопотребления процессов
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Критерии готовности:
    - [x] Исследовать дополнительные источники данных (RAPL, eBPF)
    - [x] Улучшить точность и детализацию метрик
    - [x] Добавить интеграцию с существующей системой
    - [x] Обновить тесты и завершить интеграцию
  - Ожидаемые результаты: Более точный мониторинг энергопотребления
  - Результаты:
    - Добавлена поддержка RAPL (Running Average Power Limit) для мониторинга энергопотребления
    - Улучшена функция collect_process_energy_metrics с несколькими источниками данных
    - Улучшена интеграция с eBPF энергетическими метриками
    - Добавлена функция try_collect_rapl_energy для сбора данных из RAPL интерфейсов
    - Улучшена обработка ошибок и логирование для энергетических метрик
  - Изменённые файлы:
    - smoothtask-core/src/metrics/process.rs: Улучшена функция сбора энергетических метрик
    - smoothtask-core/src/ebpf_programs/process_energy.c: Улучшена eBPF программа для энергетического мониторинга

- [x] ST-767: Оптимизировать производительность критических путей
  - Тип: Performance / Optimization
  - Примечания: Профилирование и оптимизация производительности
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Результаты:
    - Оптимизирован сбор метрик процессов: уменьшено количество блокировок кэша и улучшена параллельная обработка
    - Добавлена поддержка пакетной обработки в системе логирования для уменьшения накладных расходов
    - Улучшена обработка кэша с уменьшением контенции на блокировках
    - Добавлены оптимизации для уменьшения накладных расходов на логирование
    - Все тесты проходят успешно
  - Изменённые файлы:
    - smoothtask-core/src/metrics/process.rs: Оптимизация параллельной обработки и кэширования
    - smoothtask-core/src/logging/log_storage.rs: Добавлена пакетная обработка записей

- [x] ST-766: Обновить документацию с учетом всех последних изменений
  - Тип: Documentation / API
  - Примечания: Обновление документации для новых функций и изменений API
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~90 минут
  - Результаты:
    - Обновлена API.md с унифицированной системой обработки ошибок
    - Добавлена документация для AppLogRotator и LogStorage
    - Добавлена документация для метрик энергопотребления процессов с RAPL
    - Добавлена документация для поддержки Wayland композиторов (включая Wayfire)
    - Созданы новые файлы документации: LOGGING_ROTATION.md и WAYLAND_COMPOSITOR_SUPPORT.md
  - Изменённые файлы:
    - docs/API.md: Обновлена система обработки ошибок
    - docs/METRICS.md: Добавлены метрики энергопотребления процессов
    - docs/LOGGING_ROTATION.md: Новая документация для системы логирования
    - docs/WAYLAND_COMPOSITOR_SUPPORT.md: Новая документация для Wayland поддержки

- [x] ST-764: Улучшить поддержку Wayland для различных композиторов
  - Тип: Rust / core / metrics / windows
  - Примечания: Расширение поддержки Wayland композиторов
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Результаты:
    - Добавлена поддержка Wayfire композитора в detect_wayland_compositor()
    - Улучшена обработка ошибок с учетом специфики Wayfire
    - Добавлены comprehensive тесты для Wayfire
    - Обновлена документация и примеры
  - Изменённые файлы:
    - smoothtask-core/src/metrics/windows_wayland.rs: Добавлена поддержка Wayfire

- [x] ST-742: Оптимизировать использование памяти в системе логирования
  - Тип: Rust / core / logging / optimization
  - Примечания: Улучшение управления памятью в системе логирования и снапшотов
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~45 минут
  - Результаты:
    - Реализована очистка по памяти с оценкой использования
    - Добавлены функции cleanup_by_memory() и estimate_memory_usage()
    - Реализована memory-aware версия add_entry_with_memory_check()
    - Добавлены comprehensive тесты для нового функционала
    - Интегрировано с системой мониторинга и health status
  - Изменённые файлы:
    - smoothtask-core/src/logging/log_storage.rs: Полная реализация memory optimization

- [x] ST-762: Зафиксировать текущие изменения и обновить документацию
  - Тип: Documentation / Git / Bugfix
  - Примечания: Исправление тестовых сбоев и подготовка к коммиту
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Результаты:
    - Исправлены тесты pattern_watcher (обновлено сообщение summary и добавлена задержка для async завершения)
    - Исправлены тесты process cache (обеспечено хранение записей в HashMap для совместимости)
    - Обновлен PLAN.md с текущим статусом
    - Все основные тесты проходят успешно
  - Изменённые файлы:
    - smoothtask-core/src/classify/pattern_watcher.rs: Исправлены тесты
    - smoothtask-core/src/metrics/process.rs: Исправлен метод cache_record и clear

- [x] ST-758: Исправить предупреждения компиляции (unused imports и assignments)
  - Тип: Rust / core / code quality
  - Примечания: Устранение предупреждений компиляции для чистого кода
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Результаты:
    - Исправлены все основные предупреждения компиляции
    - Код компилируется без ошибок
    - Улучшено качество кода и соответствие лучшим практикам Rust
  - Изменённые файлы:
    - smoothtask-core/src/classify/rules.rs: Исправлены неиспользуемые mut
    - smoothtask-core/src/classify/grouper.rs: Исправлены needless borrow
    - smoothtask-core/src/lib.rs: Исправлен collapsible if
    - smoothtask-core/src/logging/log_storage.rs: Исправлено сравнение длины
    - smoothtask-core/benches/classification_bench.rs: Удалены неиспользуемые импорты
    - smoothtask-core/tests/ebpf_integration_test.rs: Исправлены неиспользуемые mut
    - smoothtask-core/src/metrics/network.rs: Исправлены field assignment warnings

- [x] ST-760: Улучшить обработку ошибок в системе мониторинга процессов
  - Тип: Rust / core / metrics / process
  - Примечания: Улучшение обработки ошибок и сообщений в метриках процессов
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~30 минут
  - Критерии готовности:
    - [x] Проанализировать текущие сообщения об ошибках в process.rs
    - [x] Улучшить обработку ошибок при чтении /proc данных
    - [x] Добавить более информативные сообщения об ошибках
    - [x] Улучшить обработку случаев отсутствия доступа к процессам
    - [x] Добавить тесты для проверки обработки ошибок
  - Ожидаемые результаты: Более надёжная и информативная обработка ошибок
  - Результаты:
    - Улучшены сообщения об ошибках в collect_single_process для /proc/stat и /proc/status
    - Добавлены расширенные диагностические рекомендации с конкретными командами
    - Улучшена обработка ошибок в read_uid_gid с дополнительными диагностическими шагами
    - Улучшена обработка ошибок в read_cgroup_path с диагностикой cgroup
    - Улучшена обработка ошибок в calculate_uptime с диагностикой системного времени
    - Обновлены тесты для проверки новых сообщений об ошибках
    - Все тесты проходят успешно
  - Изменённые файлы:
    - smoothtask-core/src/metrics/process.rs: Улучшены сообщения об ошибках и диагностика

- [x] ST-761: Исправить ошибки компиляции в бенчмарках после добавления новых полей
  - Тип: Rust / core / benches / bugfix
  - Примечания: Исправление ошибок компиляции в бенчмарках после добавления log_file_path и изменения сигнатур функций
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~30 минут
  - Критерии готовности:
    - [x] Добавить недостающее поле log_file_path в тестовые конфигурации в simple_benchmarks.rs
    - [x] Сделать функцию matches_pattern публичной для использования в бенчмарках
    - [x] Исправить типы параметров в classification_bench.rs для соответствия новым сигнатурам
    - [x] Исправить проблемы с множественными mutable borrow в бенчмарках
    - [x] Убедиться, что все бенчмарки компилируются без ошибок
  - Ожидаемые результаты: Успешная компиляция всех бенчмарков
  - Результаты:
    - Добавлено поле log_file_path в две тестовые конфигурации в simple_benchmarks.rs
    - Функция matches_pattern сделана публичной в rules.rs
    - Исправлены все вызовы classify_process в classification_bench.rs для использования Arc<Mutex<PatternDatabase>>
    - Исправлены проблемы с множественными mutable borrow в classification_bench.rs
    - Все бенчмарки компилируются успешно
  - Изменённые файлы:
    - smoothtask-core/benches/simple_benchmarks.rs: Добавлено поле log_file_path
    - smoothtask-core/benches/classification_bench.rs: Исправлены типы и множественные borrow
    - smoothtask-core/src/classify/rules.rs: Сделана публичной функция matches_pattern

- [x] ST-757: Исправить ошибки компиляции в тестах policy/engine.rs и model/ranker.rs после добавления I/O полей
  - Тип: Rust / core / tests / bugfix
  - Примечания: Исправление ошибок компиляции в тестах после добавления новых I/O полей в ProcessRecord и AppGroupRecord
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Критерии готовности:
    - [x] Добавить недостающие I/O поля (io_read_operations, io_write_operations, io_total_operations, io_data_source) в тестовые AppGroupRecord в policy/engine.rs
    - [x] Добавить недостающие I/O поля в тестовые AppGroupRecord в model/ranker.rs
    - [x] Убедиться, что все тестовые структуры соответствуют обновлённым определениям
    - [x] Проверить успешную компиляцию после исправлений
  - Ожидаемые результаты: Успешная компиляция и прохождение тестов в policy/engine.rs и model/ranker.rs
  - Результаты:
    - Исправлены все ошибки компиляции в тестах policy/engine.rs (12+ AppGroupRecord структур)
    - Исправлены все ошибки компиляции в тестах model/ranker.rs (20+ AppGroupRecord структур)
    - Добавлены недостающие I/O поля во все тестовые структуры
    - Успешная компиляция модулей policy/engine.rs и model/ranker.rs
    - Основная библиотека компилируется успешно
  - Изменённые файлы:
    - smoothtask-core/src/policy/engine.rs: Исправлены все тестовые AppGroupRecord структуры
    - smoothtask-core/src/model/ranker.rs: Исправлены все тестовые AppGroupRecord структуры

- [x] ST-754: Улучшить систему автоматического обновления конфигурации
  - Тип: Rust / core / config / auto-update
  - Примечания: Автоматическое обновление конфигурации и паттернов без перезапуска
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Критерии готовности:
    - [x] Реализовать механизм наблюдения за файлами конфигурации
    - [x] Добавить горячую перезагрузку паттернов и политик
    - [x] Реализовать уведомления об изменениях конфигурации
    - [x] Добавить тесты для нового функционала
  - Ожидаемые результаты: Более гибкая система управления конфигурацией
  - Результаты:
    - Реализован PatternWatcher для мониторинга изменений в директории с паттернами
    - Добавлена поддержка автоматического обновления паттерн-базы
    - Интегрирована система уведомлений об изменениях паттернов
    - Добавлены тесты для нового функционала
    - Обновлена документация и примеры конфигурации
  - Изменённые файлы:
    - smoothtask-core/src/classify/pattern_watcher.rs: Полная реализация PatternWatcher
    - smoothtask-core/src/classify/rules.rs: Обновлены функции классификации для работы с Arc<Mutex<PatternDatabase>>
    - smoothtask-core/src/lib.rs: Интеграция PatternWatcher в основной цикл демона

- [x] ST-753: Реализовать расширенный мониторинг дискового ввода-вывода
  - Тип: Rust / core / metrics / io
  - Примечания: Добавление мониторинга операций ввода-вывода для процессов через /proc и eBPF
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Критерии готовности:
    - [x] Добавлены расширенные поля I/O в ProcessRecord и AppGroupRecord
    - [x] Реализована интеграция eBPF disk stats с метриками процессов
    - [x] Добавлены функции enhance_process_with_disk_stats и collect_process_metrics_with_enhanced_io
    - [x] Реализована агрегация I/O метрик в AppGroupRecord
    - [x] Добавлены fallback механизмы для систем без eBPF
    - [x] Добавлены comprehensive тесты для нового функционала
  - Ожидаемые результаты: Более точный мониторинг дисковой активности с детальной статистикой операций
  - Результаты: 
    - ProcessRecord теперь включает io_read_operations, io_write_operations, io_total_operations, io_last_update_ns, io_data_source
    - AppGroupRecord теперь включает агрегированные I/O метрики для групп процессов
    - Добавлены функции для улучшения процессов данными eBPF
    - Реализована интеграция с существующей системой метрик
    - Добавлены тесты для проверки нового функционала
  - Изменённые файлы:
    - smoothtask-core/src/logging/snapshots.rs: Добавлены новые I/O поля в ProcessRecord и AppGroupRecord
    - smoothtask-core/src/metrics/process.rs: Добавлены функции enhance_process_with_disk_stats и collect_process_metrics_with_enhanced_io
    - smoothtask-core/src/classify/grouper.rs: Добавлена агрегация I/O метрик и определение источника данных
    - Тесты: Добавлены comprehensive тесты для нового I/O функционала

- [x] ST-752: Удалить неиспользуемый метод process_events из WaylandIntrospector
  - Тип: Rust / core / metrics / windows / code quality
  - Примечания: Удаление неиспользуемого метода после рефакторинга
  - Приоритет: Низкий
  - Статус: COMPLETED
  - Время выполнения: ~5 минут
  - Результаты: Чистый код без предупреждений компилятора
  - Изменённые файлы:
    - smoothtask-core/src/metrics/windows_wayland.rs: Удалён метод process_events и обновлён тест

- [x] ST-751b: Улучшить обработку ошибок в WaylandIntrospector
  - Тип: Rust / core / metrics / windows
  - Примечания: Улучшение обработки ошибок и сообщений
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~20 минут
  - Результаты: Более надёжная работа с Wayland
  - Изменённые файлы:
    - smoothtask-core/src/metrics/windows_wayland.rs: Улучшена обработка ошибок в WaylandIntrospector

- [x] ST-751a: Улучшить обнаружение и поддержку Wayland композиторов
  - Тип: Rust / core / metrics / windows
  - Примечания: Улучшение функции detect_wayland_compositor
  - Приоритет: Средний
  - Статус: COMPLETED
  - Время выполнения: ~25 минут
  - Результаты: Более надёжное обнаружение Wayland композиторов
  - Изменённые файлы:
    - smoothtask-core/src/metrics/windows_wayland.rs: Улучшена функция detect_wayland_compositor

- [x] ST-750c: Реализовать базовый сбор метрик энергопотребления процессов
  - Тип: Rust / core / metrics / energy
  - Примечания: Реализация сбора энергопотребления через /proc и RAPL
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~45 минут
  - Результаты: Базовый мониторинг энергопотребления на уровне процессов
  - Изменённые файлы:
    - smoothtask-core/src/metrics/process.rs: Добавлена collect_process_energy_metrics и интеграция
    - smoothtask-core/src/model/ranker.rs: Обновлены тестовые данные с полями энергопотребления

- [x] ST-750b: Завершить обновление тестовых данных с полями энергопотребления
  - Тип: Rust / core / tests
  - Примечания: Завершение обновления тестовых данных во всех модулях
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Результаты: Все тесты компилируются и проходят с новыми полями энергопотребления
  - Изменённые файлы:
    - Различные модули: Обновлены тестовые данные с полями энергопотребления

- [x] ST-750a: Добавить поля энергопотребления в структуру ProcessRecord
  - Тип: Rust / core / logging
  - Примечания: Добавление полей для хранения метрик энергопотребления процессов
  - Приоритет: Высокий
  - Статус: COMPLETED
  - Время выполнения: ~60 минут
  - Результаты: Структуры данных обновлены с полями энергопотребления
  - Изменённые файлы:
    - smoothtask-core/src/logging/snapshots.rs: Добавлены поля энергопотребления и тесты

*(Более старые выполненные задачи перенесены в архив: docs/history/PLAN_DONE_archive.md)*

## 4. Блокеры

- [x] ST-099: Вернуть зависимость onnxruntime с нужными фичами
  - Тип: Dependency / ML
  - Примечания: Использование ort 2.0.0-rc.10 для ONNX runtime
  - Статус: COMPLETED
  - Время выполнения: ~10 минут
  - Критерии готовности:
    - [x] Проверить доступность необходимых фич в текущей версии ort
    - [x] Обновить зависимости для использования ort с нужными фичами
    - [x] Проверить совместимость с текущим кодом
  - Ожидаемые результаты: Работающая интеграция ONNX runtime
  - Результаты: Текущая версия ort 2.0.0-rc.10 предоставляет все необходимые фичи для работы с ONNX моделями
  - Изменённые файлы:
    - smoothtask-core/Cargo.toml: Использование ort 2.0.0-rc.10 с фичей onnx
    - smoothtask-core/src/classify/ml_classifier.rs: Исправлены импорты для совместимости с текущей версией ort
    - smoothtask-core/src/model/onnx_ranker.rs: Использование актуальных импортов ort